{% extends 'base.html' %}

{% block title %}
    메인페이지
    
{% endblock %}

{% block content %}
{% load static %}
    <link rel="stylesheet" href="{% static 'main.css' %}">
    <div class="mainfoodwrap">
        <div class="mainfoodimgs">
            <img class="mainfoodimg" src="{% static 'food/main food.jpg' %}">
        </div>
        <div class="mainfoodtext">
            <h1>오늘의 맛집</h1>
        </div>
    </div>
    <div class="scorll_container">
        <div class="scroll"> 
            <img src="{% static 'img/home.png' %}">
        </div>
        </div>
    <div class="category">
        {% for cate in categoies %}
        <a href="/category/{{cate.id}}">
            <div class="food">
                <div class="kfoodimg">{{cate.desc}}</div>
                <div class="kfoodtext">{{cate.category}}</div>
            </div>
        </a>
        {% endfor %}

    </div>

    <div class="listwrap">
        <div><a href="/main/" class="list" id="m_list"><b>맛집리스트</b></a></div>
        <div><a class="list" id="d_list"><b>돌추리스트</b></a></div>
    </div>
    <!-- <hr style="width: 1000px; border-color:#F9AB5E; background-color:#F9AB5E; border:0.5"> -->
    <div id="m_storelist">
            {% for food in food_data %}
            <div class="m-storelist">
                <a href="/detail/{{food.id}}"><div><img class="storeimg" src="{{food.img}}"></div></a>
                <a href="/detail/{{food.id}}"><div class="storedetail">
                    <div class="storename">
                        <h2>{{food.store}}</h2>
                    </div>
                    <div class="address">
                        <h3>{{food.address}}</h3>
                    </div></a>
                </div>


            </div>
            <!-- <hr style="width: 1000px; border-color:#F9AB5E; background-color:#F9AB5E; border:0.5"> -->
            {% endfor %}
            <diV id="test1" class="test">
            </diV>
                <script>
                $(document).ready(function () {
                });
                $(".scroll").hide()
                $(".scroll").click(function() {
                $("html, body").animate({ scrollTop: 0 });
                });
                window.onscroll = function() {
                if ((window.innerHeight + window.scrollY) > document.body.offsetHeight) {
                    $(".scroll").show()
                    $.ajax({
                            url : "{% url 'ajax_method' %}",
                            type : "GET",   
                            // data:{
                            // },
                            // datatype: 'json',     
                            success : function(test) {  
                                let test1 = document.getElementById('#test1')
                                test.forEach(function(element){
                                    let store = element['fields']['store']
                                    let address = element['fields']['address']
                                    let id = element['pk']
                                    let img = element['fields']['img']

                                    console.log(store)
                                        $("#test1").append(`
                                            <a href="/detail/${id}"><div class="m-storelist">
                                                <div><img class="storeimg" src="${img}"></div>
                                                <div class="storedetail">
                                                    <div class="storename">
                                                        <h2>${store}</h2>
                                                    </div>
                                                    <div class="address">
                                                        <h3>${address}</h3>
                                                    </div>
                                                </div>
                                            </div></a>
                                                `)
                                });    
                            },
                        });
                    };
                }
                </script>
                <script type="text/javascript" src="{% static 'main.js' %}"></script>


    {% endblock %}